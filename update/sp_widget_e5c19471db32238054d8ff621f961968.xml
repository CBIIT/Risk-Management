<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function($scope,spModal, $location, $rootScope, RiskMgmtPOC, RiskMgmtUser, RiskMgmtRisk) {
  /* widget controller */
  var c = this;
	var s = $location.search();

	var cb = null;
	c.data.enterprise = "N/P";
	c.data.response = "N/P";
	c.data.au_recommend = 'N/P';
	c.data.ompc_recommend = 'N/P';
	c.data.eo_final_decision = 'N/P';

	c.data.saving = false;
	c.data.save_text = 'Save';

	c.data.sharedRisk = false;

	c.data.tab_1 = {
		isOpen:true
	};
	c.data.tab_2 = {
		isOpen:false
	};
	c.data.tab_3 = {
		isOpen:false
	};
	c.data.tab_4 = {
		isOpen:false
	};
	c.data.tab_5 = {
		isOpen:false
	};
	c.data.tab_6 = {
		isOpen:false
	};
	
	var prependedTitle = "(Shared) "

	c.updateScore = function(){
		if(c.data.inplace == "10"){
			c.data.effective = "0";
			c.data.include = "0.0";
		}
		c.data.impact_score = parseInt(c.data.impact)
			+ parseFloat(c.data.pub_impact)
			+ parseFloat(c.data.org_impact)
			+ parseFloat(c.data.financial_impact)
			+ parseFloat(c.data.overall_impact);
		c.data.likelihood_score = parseFloat(c.data.inplace)
			+ parseFloat(c.data.effective)
			+ parseFloat(c.data.include)
			+ parseFloat(c.data.aware)
			+ parseFloat(c.data.formal_action)
			+ parseFloat(c.data.likelihood);
		c.data.total_score = c.data.impact_score + c.data.likelihood_score;
	}

	c.updateDoc = function(item){
		if(item.selected){
			c.data.selectedDocs.push(item.doc);
		}
		else{
			var idx = c.data.selectedDocs.indexOf(item.doc);
			if (idx > -1) {
				c.data.selectedDocs.splice(idx, 1);
			}
		}
	}

	c.gotoPage = function(page,sub){
		s.xpage = page;
		s.sub = sub;
		s.fib = null;
		s.next = null;
		$location.search(s).replace();
	}

	c.collapseAll = function(){
		c.data.tab_1.isOpen = false;
		c.data.tab_2.isOpen = false;
		c.data.tab_3.isOpen = false;
		c.data.tab_4.isOpen = false;
		c.data.tab_5.isOpen = false;
		c.data.tab_6.isOpen = false;
	}

	c.expandAll = function(){
		c.data.tab_1.isOpen = true;
		c.data.tab_2.isOpen = true;
		c.data.tab_3.isOpen = true;
		c.data.tab_4.isOpen = true;
		c.data.tab_5.isOpen = true;
		c.data.tab_6.isOpen = true;
	}

	c.goAhead = function(){
		if(cb){
			cb();
		}
	};

	c.data.setPartialRiskTitleReadOnly = function() {
			var readOnlyLength = prependedTitle.length;

			$('#title').on('keypress, keydown', function(event) {
				if(c.data.sharedRisk){
					if((event.metaKey || event.ctrlKey) && event.which === 67) {
						return true;
					}
					else if (((event.which < 37 || event.which > 39) && this.selectionStart < readOnlyLength) || 
									(event.which === 8 && this.selectionStart === readOnlyLength) ||
									(event.which === 8 && (event.metaKey || event.ctrlKey || event.altKey))) {
						return false;
					}
				}
			});
	};
	
	 c.data.toggleSharedRiskTitle = function() {
     var currentTitle = $("#title").val();

     if(c.data.sharedRisk) {
       if(currentTitle.indexOf('(Shared)') != 0) {
         $('#title').val(prependedTitle + currentTitle);
				 c.data.setPartialRiskTitleReadOnly();
       }
     }
     else {
       $('#title').val(currentTitle.slice(prependedTitle.length,currentTitle.length));
     }
   };
	
	c.cancelConfirm = function(){
		$('#confirmDiv').modal('hide');
	};

	c.saveRiskandNotify = function(notify){
		var params = {};
		params.fiscalYear = c.data.fiscalYear;
		params.docs = "";
		params.manager_names = "";
		params.manager_ids = "";
		params.poc_names = "";
		params.poc_ids = "";
		params.sharedRisk = c.data.sharedRisk;
		if(c.data.sharedRisk){
			params.docs = c.data.selectedDocs.join(",");
		}
		else if(c.data.displayType == "POC"){
			params.docs = c.data.docs_list[0].doc;
			params.manager_names = c.data.managers_dict[params.docs].name;
			params.manager_ids = c.data.managers_dict[params.docs].id;
			params.poc_names = $rootScope.user.info.name;
			params.poc_ids = $rootScope.user.info.id;
		}
		else{
			params.docs = c.data.selectedDocs.join(",");
			c.data.selectedDocs.forEach(function(doc){
				params.manager_names += c.data.managers_dict[doc].name + "|";
				params.manager_ids += c.data.managers_dict[doc].id + "|";
				params.poc_names += c.data.selectedPOC[doc].name + ",";
				params.poc_ids += c.data.selectedPOC[doc].id + ",";
			});
			params.manager_names = params.manager_names.substring(0,params.manager_names.length - 1);
			params.manager_ids = params.manager_ids.substring(0,params.manager_ids.length - 1);
			params.poc_names = params.poc_names.substring(0,params.poc_names.length - 1);
			params.poc_ids = params.poc_ids.substring(0,params.poc_ids.length - 1);
		}
		params.title = c.data.title;
		params.section_1 = {};
		params.section_1.enterprise = c.data.enterprise;
		params.section_1.response = c.data.response;
		params.section_1.ownership = c.data.ownership;
		params.section_1.r_managers = c.data.r_managers;
		params.section_1.statement = c.data.statement;
		params.section_1.immediacy = c.data.immediacy;
		params.section_1.control = c.data.control;
		params.section_1.interest = c.data.interest;
		params.section_1.interest_other = c.data.interest_other;
		params.section_1.category = c.data.category;
		params.section_1.category_other = c.data.category_other;
		params.section_1.subcategory = c.data.subcategory;
		params.policies = c.data.policies;
		params.activities = c.data.activities;
		params.plan = c.data.plan;
		params.section_2 = {};
		params.section_2.impact = c.data.impact;
		params.section_2.pub_impact = c.data.pub_impact;
		params.section_2.org_impact = c.data.org_impact;
		params.section_2.financial_impact = c.data.financial_impact;
		params.section_2.overall_impact = c.data.overall_impact;
		params.section_3 = {};
		params.section_3.inplace = c.data.inplace;
		params.section_3.effective = c.data.effective;
		params.section_3.include = c.data.include;
		params.section_3.aware = c.data.aware;
		params.section_3.formal_action = c.data.formal_action;
		params.section_3.likelihood = c.data.likelihood;
		params.section_4 = {};
		params.section_4.impact_score = c.data.impact_score;
		params.section_4.likelihood_score = c.data.likelihood_score;
		params.score = c.data.total_score;
		params.au_recommend = c.data.au_recommend;
		params.ompc_recommend = c.data.ompc_recommend;
		params.eo_final_decision = c.data.eo_final_decision;
		params.section_6 = {};
		params.section_6.rationale = c.data.rationale;
		params.section_6.form_comments = c.data.form_comments;
		params.isPOC = c.data.role.indexOf('RC') > -1 || c.data.role.indexOf('RT') > -1 ? "0" : "1";
		params.notify = notify? "1" : "0";
		params.email_content = "";
		if(params.isPOC == "0" && notify){
			params.email_content = c.data.notify_poc_create_email_content;
		}
		c.data.saving = true;
		c.data.save_text = 'Saving...';
		RiskMgmtRisk.create(params, c.data.sessionId).then(function(rs){
			var data = rs.data.result;
			c.data.saving = false;
			c.data.save_text = 'Save';
			$scope.myForm.$setPristine();
			var message = "";
			if(notify){
				message = "Risk has been successfully created, and the Risk " + 
					((c.data.role.indexOf('RC') > -1 || c.data.role.indexOf('RT') > -1) ? "POC" : "Team Member") + " has been notified.";
			}
			else{
				message = "Risks have been successfully created.";
			}
			window.showMessageBox(message,{xpage:'management',sub:'board'});
		}, function(error){
			console.log(error);
		});
	};

	c.createRisks = function(){
		//if Manager or POC create
		if(c.data.sharedRisk){

				var params = {};
				params.fiscalYear = c.data.fiscalYear;
				params.docs = "";
				params.manager_names = "";
				params.manager_ids = "";
				params.poc_names = "";
				params.poc_ids = "";
				params.sharedRisk = c.data.sharedRisk;
				params.docs = c.data.selectedDocs.join(",");
//				if(c.data.selectedDocs.length < 2){
//					window.showMessageBox("Please select at least 2 DOCs for Shared Risk.");
//					return;
//				}
				params.title = c.data.title;
				params.section_1 = {};
				params.section_1.enterprise = c.data.enterprise;
				params.section_1.response = c.data.response;
				params.section_1.ownership = c.data.ownership;
				params.section_1.r_managers = c.data.r_managers;
				params.section_1.statement = c.data.statement;
				params.section_1.immediacy = c.data.immediacy;
				params.section_1.control = c.data.control;
				params.section_1.interest = c.data.interest;
				params.section_1.interest_other = c.data.interest_other;
				params.section_1.category = c.data.category;
				params.section_1.category_other = c.data.category_other;
				params.section_1.subcategory = c.data.subcategory;
				params.policies = c.data.policies;
				params.activities = c.data.activities;
				params.plan = c.data.plan;
				params.section_2 = {};
				params.section_2.impact = c.data.impact;
				params.section_2.pub_impact = c.data.pub_impact;
				params.section_2.org_impact = c.data.org_impact;
				params.section_2.financial_impact = c.data.financial_impact;
				params.section_2.overall_impact = c.data.overall_impact;
				params.section_3 = {};
				params.section_3.inplace = c.data.inplace;
				params.section_3.effective = c.data.effective;
				params.section_3.include = c.data.include;
				params.section_3.aware = c.data.aware;
				params.section_3.formal_action = c.data.formal_action;
				params.section_3.likelihood = c.data.likelihood;
				params.section_4 = {};
				params.section_4.impact_score = c.data.impact_score;
				params.section_4.likelihood_score = c.data.likelihood_score;
				params.score = c.data.total_score;
				params.au_recommend = c.data.au_recommend;
				params.ompc_recommend = c.data.ompc_recommend;
				params.eo_final_decision = c.data.eo_final_decision;
				params.section_6 = {};
				params.section_6.rationale = c.data.rationale;
				params.section_6.form_comments = c.data.form_comments;
				params.isPOC = c.data.role.indexOf('RC') > -1 || c.data.role.indexOf('RT') > -1 ? "0" : "1";
				c.data.saving = true;
				c.data.save_text = 'Saving...';
				RiskMgmtRisk.create(params, c.data.sessionId).then(function(rs){
					var data = rs.data.result;
					c.data.saving = false;
					c.data.save_text = 'Save';
					$scope.myForm.$setPristine();
					window.showMessageBox("Risks have been successfully created.",{xpage:'management',sub:'board'});
				}, function(error){
					console.log(error);
				});
		}
		else if(c.data.role.indexOf('RC') == -1 && c.data.role.indexOf('RT') == -1){
			//if RC or RT create
			c.data.confirmMessage = "Are you ready to create this new risk?";
			//post to server
			cb = function(){
				c.saveRiskandNotify(true);
			};
			$('#confirmDiv').modal('show');
		}
		else {
			//if RC or RT create
			c.data.confirmMessage = "Are you ready to create this new risk?";
			
			cb = function() {
				showNotificationDialog();
		};
		
		$('#confirmDiv').modal('show');
		}
	}
	
	c.showNotificationDialog = function() {
		c.data.confirmMessage = "<p>Would you like to notify the <b>Risk " + 
			((c.data.role.indexOf('RC') > -1 || c.data.role.indexOf('RT') > -1) ? "POC</b>?" : "Team Member</b>?") + "</p>";
		cb = function() {
			c.saveRiskandNotify(c.data.notifyPOC);
		};
		$('#notificationDialog').modal('show');
	}
	
	c.createRiskNotifyPOC = function(notifyPOC) {
		c.data.notifyPOC = notifyPOC;
		c.goAhead();
	}
	

	var pm = {};
	c.data.displayType = "RC/RT";
	c.data.role = $rootScope.user.role;
	if($rootScope.user && $rootScope.user.doc.length > 0){
		pm.doc = $rootScope.user.doc.join(",");
		c.data.displayType = $rootScope.user.doc.length == 1 ? "POC" : "POC-M";
	}

	RiskMgmtPOC.getList(pm,c.data.sessionId).then(function(rs){
		var result = rs.data.result;
		c.data.docs_list = [];
		c.data.pocs_dict = {};
		c.data.managers_dict = {};
		c.data.selectedDocs = [];
		c.data.selectedPOC = {};
		result.forEach(function(element){
			c.data.docs_list.push({doc: element.doc});
			var idx = 0;
			var pocs_arr = element.poc_id.split(',');
			var arr = [];
			element.poc_name.split(',').forEach(function(p){
				var tmp = {};
				tmp.name = p;
				tmp.id = pocs_arr[idx];
				arr.push(tmp);
				idx++;
			});
			c.data.pocs_dict[element.doc] = arr;
			c.data.selectedPOC[element.doc] = arr[0];
			c.data.managers_dict[element.doc] = {};
			c.data.managers_dict[element.doc].id = element.manager_id;
			c.data.managers_dict[element.doc].name = element.manager_name;
			c.data.impact_score = 0;
			c.data.likelihood_score = 0;
			c.data.total_score = c.data.impact_score + c.data.likelihood_score;
		});
	},function(error){
		console.log(error);
	});

	window.onbeforeunload = function(e){
		if ($scope.myForm.$dirty) {
			return "You RCF has unsaved changes, do you still want to leave this page?";
		}
	};

	var leaveFlag = true;

	$scope.$on('$locationChangeStart', function(event, next, current) {
		if ($scope.myForm.$dirty && leaveFlag) {
			var idx = next.indexOf('?');
			var dict = next.substring(idx+1).split('&')
				.map(function(element){
					return element.split('=');
				})
				.reduce(function(acc, curr) {
				acc[curr[0]] = curr[1]; return acc; }, {});
			event.preventDefault();
			spModal.open({
			 title: 'Leave page?',
			 message: "You RCF has unsaved changes, do you still want to leave this page?",
			 buttons: [
                {label:'Leave', primary: true},
                {label:'Stay', cancel: true}
            ]
			}).then(function() {
          //c.gotoPage(dict.xpage,dict.sub,dict.fid);
				  leaveFlag = false;
				  c.gotoPage(dict.xpage,dict.sub);
        }, function() {

        })
		}
	});
}]]></client_script>
        <controller_as>c</controller_as>
        <css/>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>riskmgmt_new_risk</id>
        <internal>false</internal>
        <link/>
        <name>riskmgmt new risk</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
  /* populate the 'data' object */
  /* e.g., data.table = $sp.getValue('table'); */
	data.sessionId = gs.getSession().getSessionToken();
	var today = new Date();
	if(today.getMonth() > 9){
		data.fiscalYear = today.getFullYear() + 1;
	}
	else{
		data.fiscalYear = today.getFullYear();
	}
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>yuw5@nih.gov</sys_created_by>
        <sys_created_on>2019-01-04 23:15:50</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>e5c19471db32238054d8ff621f961968</sys_id>
        <sys_mod_count>517</sys_mod_count>
        <sys_name>riskmgmt new risk</sys_name>
        <sys_package display_value="Risk Management" source="x_naci_risk_manage">76bb7febdb82a70054d8ff621f961905</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Risk Management">76bb7febdb82a70054d8ff621f961905</sys_scope>
        <sys_update_name>sp_widget_e5c19471db32238054d8ff621f961968</sys_update_name>
        <sys_updated_by>georgejc@nih.gov</sys_updated_by>
        <sys_updated_on>2020-04-20 12:28:31</sys_updated_on>
        <template><![CDATA[<div class="newrisk-content">
	<div class="newrisk-nav">
  	<a href="javascript:void(0)" ng-click="c.gotoPage('management','board');">Risk Management</a>
    <span><i class="fa fa-chevron-right" style="margin-left:10px;margin-right:10px;"></i>Create New Risk</span>
  </div>
  <form name="myForm" confirm-on-exit>
  <div class="container newrisk-block">
    <h4 style="text-align:center;">
      New Risk
    </h4>
    <div class="basic-info-section">
      <div class="form-section" style="display:flex;">
        <div class="col-md-1" style="line-height:35px;text-align:right;">Fiscal Year:</div>
        <div class="col-md-3">
          <input type="text" ng-model="c.data.fiscalYear" id="doc" name="doc" value="{{c.data.fiscalYear}}" disabled="true" class="form-control">
        </div>
        <div class="col-md-8" style="line-height:35px;text-align:right;" ng-if="c.data.role.indexOf('RC') > -1 || c.data.role.indexOf('RT') > -1">
          <input type="checkbox" class="chekbox-input ng-pristine ng-untouched ng-valid ng-empty" ng-model="c.data.sharedRisk" role="checkbox" ng-change="c.data.toggleSharedRiskTitle()" aria-invalid="false">&nbsp;Mark as shared Risk
        </div>
      </div>
      <div class="form-section" style="display:flex;" ng-if="!c.data.sharedRisk && (c.data.displayType == 'RC/RT' || c.data.displayType == 'POC-M')">
        <div class="col-md-1" style="text-align:right;"><i class="fa fa-asterisk" aria-hidden="true" style="font-size:8px;color:#B22222;"></i> DOCs:</div>
        <div class="col-md-11 doc_list_block">
          <ul>
            <li ng-repeat="item in c.data.docs_list">
              <input type="checkbox" class="chekbox-input ng-pristine ng-untouched ng-valid ng-empty" ng-model="item.selected" ng-click="c.updateDoc(item)" value="{{item.doc}}" role="checkbox" aria-invalid="false" ng-checked="true" ng-checked="c.data.selectedDocs.indexOf(item.doc) > -1">&nbsp;{{item.doc}}
            </li>
          </ul>
          <div class="doc_content_block" ng-if="c.data.selectedDocs.length > 0 && !c.data.sharedRisk">
            <div class="doc_item_block" ng-repeat="doc in c.data.selectedDocs">
              <h4 class="doc_block_title">{{doc}}</h4>
              <label>Manager:</label>
              <input type="text" id="{{doc}}_manager" name="manager" value="{{c.data.managers_dict[doc].name}}" disabled="true" class="form-control">
              <label>POC:</label>
              <select class="form-control" name="pocSelect" id="{{doc}}_pocSelect" ng-options="option.name for option in c.data.pocs_dict[doc] track by option.id"
                      ng-model="c.data.selectedPOC[doc]" ng-disabled="c.data.displayType == 'POC-M'">
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="risk-form-section">
      <div class="risk-top-button">
        <a href="javascript:void(0)" ng-click="c.collapseAll();">Collapse All</a>
        <a href="javascript:void(0)" ng-click="c.expandAll();">Expand All</a>
      </div>
      <h4 style="text-align:center;font-weight:bold;">
        Risk Capture Form
      </h4>
      <uib-accordion close-others="false">
        <div uib-accordion-group class="panel-default" is-open="c.data.tab_1.isOpen">
          <uib-accordion-heading>
            <div>
              Section 1: Risk Identification <i class="pull-right" ng-class="{'fa fa-minus-square': c.data.tab_1.isOpen, 'fa fa-plus-square': !c.data.tab_1.isOpen}"></i>
            </div>
          </uib-accordion-heading>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;"><i class="fa fa-asterisk" aria-hidden="true" style="font-size:8px;color:#B22222;"></i> Risk Title</div>
            <div class="col-md-10">
              <!-- <input type="text" ng-model="c.data.title" id="title" name="title" value="{{c.data.title}}" class="form-control"> -->
              <textarea rows=1 ng-model="c.data.title" id="title" name="title" style="resize: vertical;"  value="{{c.data.title}}"  class="form-control"></textarea>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;">Is this an Enterprise Risk?</div>
            <div class="col-md-10" style="line-height:35px;">
              <input type="radio" ng-model="c.data.enterprise" value="Yes" name="enterprise"> Yes
              <input type="radio" ng-model="c.data.enterprise" value="No" name="enterprise"> No
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;">Risk Response</div>
            <div class="col-md-10" style="line-height:35px;">
              <input type="radio" ng-model="c.data.response" value="Accept" name="response"> Accept
              <input type="radio" ng-model="c.data.response" value="Reduce" name="response"> Reduce
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;">Functional Ownership</div>
            <div class="col-md-5">
              <!-- <input type="text" ng-model="c.data.ownership" id="ownership" name="ownership" value="{{c.data.ownership}}" class="form-control"> -->
              <textarea rows=1 ng-model="c.data.ownership" id="ownership" name="ownership" style="resize: vertical;"  value="{{c.data.ownership}}" class="form-control"></textarea>
            </div>
          </div>
          <!--
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;">Risk Managers</div>
            <div class="col-md-10">
              <input type="text" ng-model="c.data.r_managers" id="r_managers" name="r_managers" value="{{c.data.r_managers}}" class="form-control">
            </div>
          </div>
          -->
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">Risk Statement</div>
            <div class="col-md-10">
              <textarea rows=3 ng-model="c.data.statement" id="statement" name="statement" style="resize: vertical;"  value="{{c.data.statement}}" class="form-control"></textarea>
              <span style="color:darkgray;">Please make sure no special characters exist in above field.</span>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;">Immediacy</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.immediacy" id="immediacy" name="immediacy" ng-init="c.data.immediacy = 'N/P'">
                <option value="N/P"></option>
                <option value="in the past">The risk has occurred in the past.</option>
                <option value="uncertain">It is uncertain when the risk may occur.</option>
                <option value="one month">The risk may occur within one month.</option>
                <option value="six months">The risk may occur within six months.</option>
                <option value="one year">The risk may occur within one year.</option>
                <option value="more than one year">The risk may occur more than a year from now.</option>
                <option value="N/A">N/A</option>
              </select>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;">Span of Control</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.control" id="control" name="control" ng-init="c.data.control = 'N/P'">
                <option value="N/P"></option>
                <option value="handled by IC/OD">The risk can be handled by the IC/OD Office.</option>
                <option value="can be managed by NIH">The risk cannot be handled by the IC/OD Office, but can be managed by the NIH.</option>
                <option value="cannot be directly managed">The risk is external to the NIH and cannot be directly managed.</option>
              </select>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;">Special Interest Risk</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.interest" id="interest" name="interest" ng-init="c.data.interest = 'N/P'">
                <option value="N/P"></option>
                <option value="N/A">N/A</option>
                <option value="Other">Other</option>
              </select>
            </div>
            <div class="col-md-5">
              <!-- <input type="text" ng-if="c.data.interest == 'Other'" placeholder="Please specify"  ng-model="c.data.interest_other" id="interest_other" name="interest_other" value="{{c.data.interest_other}}" class="form-control"> -->
              <textarea rows=1 ng-if="c.data.interest == 'Other'" placeholder="Please specify"  ng-model="c.data.interest_other" id="interest_other" name="interest_other" style="resize: vertical;"  value="{{c.data.interest_other}}" class="form-control"></textarea>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;">Risk Category</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.category" id="category" name="category" ng-init="c.data.category = 'N/P'">
                <option value="N/P"></option>
                <option value="Acquisitions">Acquisitions</option>
                <option value="Ethics">Ethics</option>
                <option value="Extramural">Extramural</option>
                <option value="Facilities">Facilities</option>
                <option value="Financial">Financial</option>
                <option value="Human Capital">Human Capital</option>
                <option value="Information Management">Information Management</option>
                <option value="Intramural">Intramural</option>
                <option value="Management Initiatives">Management Initiatives</option>
                <option value="Other">Other</option>
              </select>
            </div>
            <div class="col-md-5">
              <!-- <input type="text" ng-if="c.data.interest == 'Other'" placeholder="Please specify"  ng-model="c.data.interest_other" id="interest_other" name="interest_other" value="{{c.data.interest_other}}" class="form-control"> -->
              <textarea rows=1 ng-if="c.data.category == 'Other'" placeholder="Please specify"  ng-model="c.data.category_other" id="category_other" name="category_other" style="resize: vertical;"  value="{{c.data.category_other}}" class="form-control"></textarea>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;">Risk Subcategory</div>
            <div class="col-md-10">
              <!-- <input type="text" ng-model="c.data.subcategory" id="subcategory" name="subcategory" value="{{c.data.subcategory}}" class="form-control"> -->
              <textarea rows=1 ng-model="c.data.subcategory" id="subcategory" name="subcategory" style="resize: vertical;"  value="{{c.data.subcategory}}" class="form-control"></textarea>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">What are the primary policies and procedures in place to manage this risk?</div>
            <div class="col-md-10">
              <textarea rows=5 ng-model="c.data.policies" id="policies" name="policies" style="resize: vertical;"  value="{{c.data.policies}}" class="form-control"></textarea>
              <span style="color:darkgray;">Please make sure no special characters exist in above field.</span>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">What are the risk management activities undertaken this fiscal year related to this risk? (FMFIA Support)</div>
            <div class="col-md-10">
              <textarea rows=5 ng-model="c.data.activities" id="activities" name="activities" style="resize: vertical;"  value="{{c.data.activities}}" class="form-control"></textarea>
              <span style="color:darkgray;">Please make sure no special characters exist in above field.</span>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">Describe the Action Plan for a REDUCE Risk Response or the Rationale for Choosing an ACCEPT Risk Response</div>
            <div class="col-md-10">
              <textarea rows=5 ng-model="c.data.plan" id="plan" name="plan" style="resize: vertical;"  value="{{c.data.plan}}" class="form-control"></textarea>
              <span style="color:darkgray;">Please make sure no special characters exist in above field.</span>
            </div>
          </div>
        </div>
        <div uib-accordion-group class="panel-default" is-open="c.data.tab_2.isOpen">
          <uib-accordion-heading>
            <div>
              Section 2: Risk Impact <i class="pull-right" ng-class="{'fa fa-minus-square': c.data.tab_2.isOpen, 'fa fa-plus-square': !c.data.tab_2.isOpen}"></i>
            </div>
          </uib-accordion-heading>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">What is the Impact on your IC/OD Office Mission?</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.impact" id="impact" name="impact" ng-init="c.data.impact = '0'" ng-change="c.updateScore()">
                <option value="0"></option>
                <option value="1">Minimal to no Effect</option>
                <option value="3">Significant Effect</option>
                <option value="5">Severe Effect</option>
              </select>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">What is the impact on Public Trust?</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.pub_impact" id="pub_impact" name="pub_impact" ng-init="c.data.pub_impact = '0'" ng-change="c.updateScore()">
                <option value="0"></option>
                <option value="1">Minimal to no Effect</option>
                <option value="3">Significant Effect</option>
                <option value="5">Severe Effect</option>
              </select>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">What is the Organizational Impact?</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.org_impact" id="org_impact" name="org_impact" ng-init="c.data.org_impact = '0'" ng-change="c.updateScore()">
                <option value="0"></option>
                <option value="1">Single IC or OD Office</option>
                <option value="3">More than one IC and OD office</option>
                <option value="5">All of NIH and may extend beyond</option>
              </select>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">What is the Financial Impact to your IC/OD Office?</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.financial_impact" id="financial_impact" name="financial_impact" ng-init="c.data.financial_impact = '0'" ng-change="c.updateScore()">
                <option value="0"></option>
                <option value="1">Up to $500,000</option>
                <option value="3">$500,000 to $5 Million</option>
                <option value="5">Greater than $5 Million</option>
              </select>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">In your professional judgement, what would be the overall impact on your IC/OD Office if this risk occurred?</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.overall_impact" id="overall_impact" name="overall_impact" ng-init="c.data.overall_impact = '0'" ng-change="c.updateScore()">
                <option value="0"></option>
                <option value="1">Minimal to no Effect</option>
                <option value="3">Significant Effect</option>
                <option value="5">Severe Effect</option>
              </select>
            </div>
          </div>
        </div>
        <div uib-accordion-group class="panel-default" is-open="c.data.tab_3.isOpen">
          <uib-accordion-heading>
            <div>
              Section 3: Risk Likelihood <i class="pull-right" ng-class="{'fa fa-minus-square': c.data.tab_3.isOpen, 'fa fa-plus-square': !c.data.tab_3.isOpen}"></i>
            </div>
          </uib-accordion-heading>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">Are written policies, procedures, or controls in place to manage this risk?</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.inplace" id="inplace" name="inplace" ng-init="c.data.inplace = '0.0'" ng-change="c.updateScore()">
                <option value="0.0"></option>
                <option value="0">Yes</option>
                <option value="10">No</option>
              </select>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">Are written policies, procedures, and controls effective?</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.effective" id="effective" name="effective" ng-init="c.data.effective = '0'" ng-change="c.updateScore()" ng-disabled="c.data.inplace == '10'">
                <option value="0"></option>
                <option value="0.5">Strongly Agree</option>
                <option value="1.5">Agree</option>
                <option value="4">Disagree</option>
                <option value="5">Strongly Disagree</option>
              </select>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">Are all policies included in formal Federal, HHS, NIH or IC guidance?</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.include" id="include" name="include" ng-init="c.data.include = '0.0'" ng-change="c.updateScore()" ng-disabled="c.data.inplace == '10'">
                <option value="0.0"></option>
                <option value="0">Yes</option>
                <option value="5">No</option>
              </select>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">Individuals within my IC/OD Office are aware of this risk?</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.aware" id="aware" name="aware" ng-init="c.data.aware = '0'" ng-change="c.updateScore()">
                <option value="0"></option>
                <option value="0.5">Strongly Agree</option>
                <option value="1.5">Agree</option>
                <option value="4">Disagree</option>
                <option value="5">Strongly Disagree</option>
              </select>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">Is IC/OD Office management taking formal actions to mitigate or address this risk?</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.formal_action" id="formal_action" name="formal_action" ng-init="c.data.formal_action = '0'" ng-change="c.updateScore()">
                <option value="0"></option>
                <option value="1">Yes</option>
                <option value="5">No</option>
              </select>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">In your professional judgement, what is the likelihood that the identified risk could occur?</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.likelihood" id="likelihood" name="likelihood" ng-init="c.data.likelihood = '0'" ng-change="c.updateScore()">
                <option value="0"></option>
                <option value="0.5">Very Unlikely</option>
                <option value="1.5">Unlikely</option>
                <option value="4">Likely</option>
                <option value="5">Very Likely</option>
              </select>
            </div>
          </div>
        </div>
        <div uib-accordion-group class="panel-default" is-open="c.data.tab_4.isOpen">
          <uib-accordion-heading>
            <div>
              Section 4: Risk Score Information <i class="pull-right" ng-class="{'fa fa-minus-square': c.data.tab_4.isOpen, 'fa fa-plus-square': !c.data.tab_4.isOpen}"></i>
            </div>
          </uib-accordion-heading>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;">Risk Impact</div>
            <div class="col-md-5" ng-if="c.data.impact_score <= 18.5">
              <input type="text" style="background-color:green;color:white;" ng-model="c.data.impact_score" id="impact_score" name="impact_score" value="{{c.data.impact_score}}" disabled="true" class="form-control">
            </div>
            <div class="col-md-5" ng-if="c.data.impact_score >= 19 && c.data.impact_score <= 33.5">
              <input type="text" style="background-color:yellow;color:black;" ng-model="c.data.impact_score" id="impact_score" name="impact_score" value="{{c.data.impact_score}}" disabled="true" class="form-control">
            </div>
            <div class="col-md-5" ng-if="c.data.impact_score >= 34">
              <input type="text" style="background-color:red;color:white;" ng-model="c.data.impact_score" id="impact_score" name="impact_score" value="{{c.data.impact_score}}" disabled="true" class="form-control">
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;">Risk Likelihood</div>
            <div class="col-md-5" ng-if="c.data.likelihood_score <= 18.5">
              <input type="text" style="background-color:green;color:white;" ng-model="c.data.likelihood_score" id="likelihood_score" name="likelihood_score" value="{{c.data.likelihood_score}}" disabled="true" class="form-control">
            </div>
            <div class="col-md-5" ng-if="c.data.likelihood_score >= 19 && c.data.rcf.likelihood_score <= 33.5">
              <input type="text" style="background-color:yellow;color:black;" ng-model="c.data.likelihood_score" id="likelihood_score" name="likelihood_score" value="{{c.data.likelihood_score}}" disabled="true" class="form-control">
            </div>
            <div class="col-md-5" ng-if="c.data.likelihood_score >= 34">
              <input type="text" style="background-color:red;color:white;" ng-model="c.data.likelihood_score" id="likelihood_score" name="likelihood_score" value="{{c.data.likelihood_score}}" disabled="true" class="form-control">
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;">Risk Score</div>
            <div class="col-md-5" ng-if="c.data.total_score <= 18.5">
              <input type="text" style="background-color:green;color:white;" ng-model="c.data.total_score" id="total_score" name="total_score" value="{{c.data.total_score}}" disabled="true" class="form-control">
            </div>
            <div class="col-md-5" ng-if="c.data.total_score >= 19 && c.data.total_score <= 33.5">
              <input type="text" style="background-color:yellow;color:black;" ng-model="c.data.total_score" id="total_score" name="total_score" value="{{c.data.total_score}}" disabled="true" class="form-control">
            </div>
            <div class="col-md-5" ng-if="c.data.total_score >= 34">
              <input type="text" style="background-color:red;color:white;" ng-model="c.data.total_score" id="total_score" name="total_score" value="{{c.data.total_score}}" disabled="true" class="form-control">
            </div>
          </div>
        </div>
        <div uib-accordion-group class="panel-default" is-open="c.data.tab_5.isOpen">
          <uib-accordion-heading>
            <div>
              Section 5: Risk Recommendation <i class="pull-right" ng-class="{'fa fa-minus-square': c.data.tab_5.isOpen, 'fa fa-plus-square': !c.data.tab_5.isOpen}"></i>
            </div>
          </uib-accordion-heading>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;">AU Recommend</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.au_recommend" id="au_recommend" name="au_recommend" ng-disabled="">
                <option value="N/P"></option>
                <option value="Maintain the risk">Maintain the risk</option>
                <option value="Retire the risk">Retire the risk</option>
                <option value="Add to inventory">Add to inventory</option>
                <option value="Do not add to inventory">Do not add to inventory</option>
              </select>
            </div>
          </div>
          <div class="form-section" style="display:flex;" ng-if="c.data.role.indexOf('RC') > -1 || c.data.role.indexOf('RT') > -1">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;">OMPC Recommend</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.ompc_recommend" id="ompc_recommend" name="ompc_recommend">
                <option value="N/P"></option>
                <option value="Maintain the risk">Maintain the risk</option>
                <option value="Retire the risk">Retire the risk</option>
                <option value="Add to inventory">Add to inventory</option>
                <option value="Do not add to inventory">Do not add to inventory</option>
              </select>
            </div>
          </div>
          <div class="form-section" style="display:flex;" ng-if="c.data.role.indexOf('RC') > -1">
            <div class="col-md-2" style="padding-left:0px;line-height:35px;text-align:right;">EO Final Decision</div>
            <div class="col-md-5">
              <select class="form-control" ng-model="c.data.eo_final_decision" id="eo_final_decision" name="eo_final_decision">
                <option value="N/P"></option>
                <option value="Maintain the risk">Maintain the risk</option>
                <option value="Retire the risk">Retire the risk</option>
                <option value="Add to inventory">Add to inventory</option>
                <option value="Do not add to inventory">Do not add to inventory</option>
              </select>
            </div>
          </div>
        </div>
        <div uib-accordion-group class="panel-default" is-open="c.data.tab_6.isOpen">
          <uib-accordion-heading>
            <div>
              Section 6: Other Information <i class="pull-right" ng-class="{'fa fa-minus-square': c.data.tab_6.isOpen, 'fa fa-plus-square': !c.data.tab_6.isOpen}"></i>
            </div>
          </uib-accordion-heading>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">Rationale for Red Risk, Changes to Risk Score, Changes to Risk Response, or Risk Retirement</div>
            <div class="col-md-10">
              <textarea rows=3 ng-model="c.data.rationale" id="rationale" name="rationale" style="resize: vertical;"  value="{{c.data.rationale}}" class="form-control"></textarea>
              <span style="color:darkgray;">Please make sure no special characters exist in above field.</span>
            </div>
          </div>
          <div class="form-section" style="display:flex;">
            <div class="col-md-2" style="padding-left:0px;text-align:right;">Comments</div>
            <div class="col-md-10">
              <textarea rows=3 ng-model="c.data.form_comments" id="form_comments" name="form_comments" style="resize: vertical;"  value="{{c.data.form_comments}}" class="form-control"></textarea>
              <span style="color:darkgray;">Please make sure no special characters exist in above field.</span>
            </div>
          </div>
        </div>
      </uib-accordion>
    </div>
    <div class="risk-button-section">
      <button type="button" class="table-button btn btn-primary" style="margin-right:20px;" ng-click="c.createRisks()" ng-disabled="(c.data.displayType == 'POC' && (c.data.title == undefined || c.data.title.trim() == '' || c.data.saving)) || (c.data.displayType !== 'POC' && ((!c.data.sharedRisk && c.data.selectedDocs.length == 0) || c.data.title == undefined || c.data.title.trim() == '' || c.data.saving))">
        {{c.data.save_text}}
      </button>
      <button type="button" class="table-button btn btn-primary" ng-click="c.gotoPage('management','board');">
        Cancel
      </button>
    </div>
  </div>
  </form>
</div>

<div id="confirmDiv" class="modal fade" data-keyborad="false" data-backdrop="static">
  <div class="modal-dialog modal-lg" style="width:25%;">
    <div class="modal-content" style="min-height:150px; overflow-y:auto; overflow-x: hidden;">
      <div class="modal-header">
        <h4  class="modal-title">Confirm</h4>
      </div>
      <div class="modal-body">
        <div class="col-md-12 message-box" align="center" ng-bind-html="c.data.confirmMessage"></div>
        <div class="col-md-12" style="margin-bottom:20px;"  align="center">
          <button class="btn btn-primary" style="margin-right: 20px;" ng-click="c.showNotificationDialog();" data-dismiss="modal">Yes</button>
          <button class="btn btn-primary" ng-click="c.cancelConfirm();" data-dismiss="modal">No</button>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="notificationDialog" class="modal fade" data-keyborad="false" data-backdrop="static">
  <div class="modal-dialog modal-lg" style="width:500px;">
    <div class="modal-content" style="min-height:250px; overflow-y:hidden; overflow-x: hidden;">
      <div class="modal-header">
        <h4  class="modal-title">Notification</h4>
      </div>
      <div class="modal-body">
				<div class="col-md-12 message-box" align="center" ng-bind-html="c.data.confirmMessage"></div>
				<div class="col-md-12" style="margin-bottom:20px;"  align="center">
	        <button class="btn btn-primary" style="margin-right: 20px;" ng-click="c.createRiskNotifyPOC(true);" data-dismiss="modal">Yes</button>
	        <button class="btn btn-primary" ng-click="c.createRiskNotifyPOC(false);" data-dismiss="modal">No</button>
	      </div>
      </div>
    </div>
  </div>
</div>]]></template>
    </sp_widget>
</record_update>
